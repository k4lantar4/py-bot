# ๐ 3X-UI Management System - Server Setup Guide

## ๐ ูพุดโูุงุฒูุง
- Ubuntu 20.04 ุง 22.04 LTS
- ุฏุณุชุฑุณ root ุจู ุณุฑูุฑ
- ุชูฺฉู ุจุงุช ุชูฺฏุฑุงู (ุงุฒ BotFather)

## ๐ง ูุฑุญูู 1: ุขูุงุฏูโุณุงุฒ ุงููู ุณุฑูุฑ

1. **ุงุชุตุงู ุจู ุณุฑูุฑ ุงุฒ ุทุฑู SSH**:
   ```bash
   ssh root@your_server_ip
   ```

2. **ุจูโุฑูุฒุฑุณุงู ุจุณุชูโูุง ุณุณุชู**:
   ```bash
   apt update && apt upgrade -y
   ```

3. **ูุตุจ Git**:
   ```bash
   apt install -y git
   ```

## ๐ง ูุฑุญูู 2: ุฑุงูโุงูุฏุงุฒ ูพุฑูฺู

1. **ฺฉููู ุง ุขูพููุฏ ูพุฑูฺู ุจู ุณุฑูุฑ**:
   
   ฺฉููู ุงุฒ ูุฎุฒู:
   ```bash
   git clone https://your-repository-url.git /root/py_bot
   ```
   
   ุง ุขูพููุฏ ูุงูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ SCP:
   ```bash
   # ุงุฒ ุณุณุชู ูุญู ุฎูุฏ
   ./transfer.sh
   ```

2. **ุฑูุชู ุจู ุฏุงุฑฺฉุชูุฑ ูพุฑูฺู**:
   ```bash
   cd /root/py_bot
   ```

3. **ุงุฌุฑุง ุงุณฺฉุฑูพุช ุฑุงูโุงูุฏุงุฒ**:
   ```bash
   chmod +x setup.sh
   ./setup.sh
   ```

4. **ูพฺฉุฑุจูุฏ ูุชุบุฑูุง ูุญุท**:
   
   ูุฑุงุด ูุงู `.env`:
   ```bash
   nano .env
   ```
   
   ูพุงุฑุงูุชุฑูุง ุฒุฑ ุฑุง ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ:
   - `TELEGRAM_BOT_TOKEN`: ุชูฺฉู ุจุงุช ุดูุง ุงุฒ BotFather
   - `ADMIN_USER_IDS`: ูุณุช ุดูุงุณูโูุง ฺฉุงุฑุจุฑุงู ุงุฏูู ุชูฺฏุฑุงู (ุจุง ฺฉุงูุง ุฌุฏุง ุดุฏู)
   - `API_USERNAME` ู `API_PASSWORD`: ุงฺฏุฑ ุงุฒ API ุงุณุชูุงุฏู ูโฺฉูุฏ
   - `POSTGRES_PASSWORD`: ุฑูุฒ ุนุจูุฑ ุฏุชุงุจุณ PostgreSQL
   - ุณุงุฑ ุชูุธูุงุช ููุฑุฏ ูุงุฒ

## ๐ง ูุฑุญูู 3: ุฑุงูโุงูุฏุงุฒ ุณุฑูุณโูุง

1. **ุฑุงูโุงูุฏุงุฒ ุชูุงู ุณุฑูุณโูุง**:
   ```bash
   chmod +x start_services.sh
   ./start_services.sh
   ```

2. **ุจุฑุฑุณ ูุถุนุช ุณุฑูุณโูุง**:
   ```bash
   supervisorctl status
   ```

3. **ูุดุงูุฏู ูุงฺฏโูุง ุฏุฑ ุตูุฑุช ูุงุฒ**:
   ```bash
   ./manage.sh logs
   ```

## ๐ง ูุฑุญูู 4: ุงููโุณุงุฒ ุณุฑูุฑ (ุงุฎุชุงุฑ)

ุงุฌุฑุง ุงุณฺฉุฑูพุช ุงููโุณุงุฒ:
```bash
chmod +x security.sh
./security.sh
```

ุงู ุงุณฺฉุฑูพุช:
- ุจุณุชูโูุง ุณุณุชู ุฑุง ุจูโุฑูุฒุฑุณุงู ูโฺฉูุฏ
- ูุฌูุฒูุง ูุงู ููุงุณุจ ุฑุง ุชูุธู ูโฺฉูุฏ
- ูุงุฑูุงู UFW ุฑุง ูพฺฉุฑุจูุฏ ูโฺฉูุฏ
- fail2ban ุฑุง ุจุฑุง ูุญุงูุธุช SSH ูุตุจ ู ูพฺฉุฑุจูุฏ ูโฺฉูุฏ

## ๐ง ุฏุณุชูุฑุงุช ูุฏุฑุช

ุงุฒ ุงุณฺฉุฑูพุช ูุฏุฑุช ุจุฑุง ุนููุงุช ุฑุงุฌ ุงุณุชูุงุฏู ฺฉูุฏ:

```bash
./manage.sh start    # ุดุฑูุน ุณุฑูุณโูุง
./manage.sh stop     # ุชููู ุณุฑูุณโูุง
./manage.sh restart  # ุฑุงูโุงูุฏุงุฒ ูุฌุฏุฏ ุณุฑูุณโูุง
./manage.sh status   # ุจุฑุฑุณ ูุถุนุช ุณุฑูุณโูุง
./manage.sh logs     # ูุดุงูุฏู ูุงฺฏโูุง
./manage.sh update   # ุจูโุฑูุฒุฑุณุงู ูุงุจุณุชฺฏโูุง
./manage.sh backup   # ุงุฌุงุฏ ูพุดุชุจุงู
./manage.sh help     # ููุงุด ุฑุงูููุง
```

## ๐ง ุจูโุฑูุฒุฑุณุงูโูุง ุงุณุชูุฑุงุฑ

ุจุฑุง ุงุณุชูุฑุงุฑ ุจูโุฑูุฒุฑุณุงูโูุง ุจู ุณุฑูุฑ:

1. ุงูุชูุงู ูุงูโูุง ุจูโุฑูุฒุฑุณุงู ุดุฏู ุจู ุณุฑูุฑ
2. ุงุฌุฑุง ุงุณฺฉุฑูพุช ุงุณุชูุฑุงุฑ:
   ```bash
   ./deploy.sh
   ```

## ๐ง ุนุจโุงุจ

ุงฺฏุฑ ุณุฑูุณโูุง ุดุฑูุน ุจู ฺฉุงุฑ ููโฺฉููุฏ:

1. **ุจุฑุฑุณ ูุงฺฏโูุง**:
   ```bash
   tail -f logs/backend_error.log
   tail -f logs/telegram_bot.err.log
   ```

2. **ุจุฑุฑุณ ูุชุบุฑูุง ูุญุท**:
   ```bash
   cat .env
   ```

3. **ุจุฑุฑุณ ูุงุจุณุชฺฏโูุง ูพุงุชูู**:
   ```bash
   source venv/bin/activate
   pip list
   ```

4. **ุฑุงูโุงูุฏุงุฒ ูุฌุฏุฏ ุณุฑูุณโูุง**:
   ```bash
   supervisorctl restart all
   ```

### ุฎุทุงูุง ุฑุงุฌ ู ุฑุงูโุญู ุขูโูุง

#### 1. ุฎุทุง `email-validator is not installed`

**ุนูุงุฆู ุฎุทุง**:
```
ImportError: email-validator is not installed, run `pip install pydantic[email]`
```

**ุฑุงูโุญู**:
```bash
# ุงุฌุฑุง ุงุณฺฉุฑูพุช ุฑูุน ูุงุจุณุชฺฏโูุง
./fix_dependencies.sh

# ุง ูุตุจ ุฏุณุช
source venv/bin/activate
pip install email-validator==2.0.0
supervisorctl restart backend
```

## ๐ง ูพุดุชุจุงูโฺฏุฑ ู ุจุงุฒุงุจ

**ุงุฌุงุฏ ูพุดุชุจุงู**:
```bash
./manage.sh backup
```

**ุจุงุฒุงุจ ุงุฒ ูพุดุชุจุงู**:
```bash
# ุงุจุชุฏุง ุณุฑูุณ ุฑุง ูุชููู ฺฉูุฏ
supervisorctl stop all

# ฺฉูพ ุฏุงุฏูโูุง ุงุฒ ูพุดุชุจุงู
cp -r backups/YYYYMMDD_HHMMSS/data/* data/
cp backups/YYYYMMDD_HHMMSS/.env .

# ุฑุงูโุงูุฏุงุฒ ูุฌุฏุฏ ุณุฑูุณ
supervisorctl start all
```

## ๐ง ุฏุณุชุฑุณ ุจู ุณุฑูุณโูุง

ูพุณ ุงุฒ ุฑุงูโุงูุฏุงุฒ ููููุชโุขูุฒุ ูโุชูุงูุฏ ุจู ุณุฑูุณโูุง ุฒุฑ ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ:

- **API**: `http://your_server_ip/api/v1`
- **ูุณุชูุฏุงุช API**: `http://your_server_ip/api/docs`
- **ูุฑุงูุชโุงูุฏ**: `http://your_server_ip`
- **ุจุงุช ุชูฺฏุฑุงู**: ุงุฒ ุทุฑู ุชูฺฏุฑุงู ุจุง ูุงู ฺฉุงุฑุจุฑ ุจุงุช ุฎูุฏ 