# سیستم مدیریت اکانت V2Ray

این پروژه یک سیستم مدیریت اکانت V2Ray با ربات تلگرام و داشبورد وب است که امکان فروش و مدیریت اکانت‌های V2Ray را فراهم می‌کند.

## ویژگی‌های اصلی

### ربات تلگرام
- **احراز هویت کاربران**: ثبت‌نام و ورود کاربران
- **مدیریت اکانت‌ها**: مشاهده، ایجاد و تمدید اکانت‌های V2Ray
- **پرداخت‌ها**: پرداخت کارت به کارت و درگاه زرین‌پال
- **پروفایل کاربری**: مشاهده و ویرایش اطلاعات کاربری
- **سیستم اعلان‌ها**: اطلاع‌رسانی انقضای اکانت، مصرف ترافیک و وضعیت پرداخت‌ها
- **پنل مدیریت**: مدیریت کاربران، سرورها، پرداخت‌ها و تنظیمات سیستم

### داشبورد وب
- **پنل کاربری**: مدیریت اکانت‌ها، پرداخت‌ها و پروفایل
- **پنل مدیریت**: مدیریت کاربران، سرورها، پرداخت‌ها و تنظیمات سیستم

### یکپارچه‌سازی با 3x-UI
- **مدیریت اکانت‌ها**: ایجاد و مدیریت اکانت‌ها در پنل‌های 3x-UI
- **نظارت بر ترافیک**: بررسی مصرف ترافیک اکانت‌ها
- **آمار سرور**: نظارت بر وضعیت سرورها

## تغییرات اخیر

## پنل مدیریت
- طراحی و پیاده‌سازی پنل مدیریت با امکانات کامل
  - داشبورد مدیریت با نمایش آمار و نمودارهای فروش و ترافیک
  - مدیریت کاربران با امکان جستجو، فیلتر و عملیات CRUD
  - مدیریت سرورها با نمایش وضعیت و آمار مصرف ترافیک
  - مدیریت پلن‌های اشتراک با امکان ایجاد، ویرایش و مدیریت پلن‌ها
  - گزارش‌های مالی با نمودارهای درآمد و جدول تراکنش‌ها
  - تنظیمات سیستم با بخش‌های عمومی، اعلان‌ها و پشتیبان‌گیری
  - رابط کاربری مدرن و واکنش‌گرا با پشتیبانی از RTL

## تنظیمات سیستم
- طراحی و پیاده‌سازی بخش تنظیمات سیستم
  - تنظیمات عمومی شامل نام سایت، زبان پیش‌فرض و تم
  - تنظیمات اعلان‌ها با پشتیبانی از ایمیل و تلگرام
  - تنظیمات پشتیبان‌گیری با امکان پشتیبان‌گیری خودکار و دستی
  - نمایش تاریخچه پشتیبان‌گیری با امکان بازیابی و حذف
  - ذخیره‌سازی تنظیمات با نمایش پیام موفقیت

## گزارش‌های مالی
- طراحی و پیاده‌سازی بخش گزارش‌های مالی
  - نمایش آمار کلی درآمد و تراکنش‌ها
  - نمودار ستونی درآمد ماهانه
  - نمودار دایره‌ای درآمد بر اساس نوع پلن
  - جدول تراکنش‌ها با امکان فیلتر بر اساس نوع، وضعیت و تاریخ
  - نمایش وضعیت تراکنش‌ها با رنگ‌های متمایز

## مدیریت اکانت‌ها
- طراحی و پیاده‌سازی رابط کاربری مدیریت اکانت‌ها
  - نمایش لیست اکانت‌ها با وضعیت و اطلاعات ترافیک
  - فرم ایجاد اکانت جدید با انتخاب سرور و پلن
  - نمایش تاریخچه اکانت‌ها و تراکنش‌ها
  - امکان کپی تنظیمات و نمایش QR کد
  - مدیریت اکانت‌ها (ویرایش، حذف، تمدید)

## ویژگی‌های جدید
- مدیریت کاربران با امکان جستجو و فیلتر
- مدیریت سرورها با نمایش وضعیت آنلاین/آفلاین
- مدیریت پلن‌های اشتراک با پشتیبانی از پروتکل‌های مختلف
- گزارش‌های مالی با نمودارهای تعاملی و فیلترهای پیشرفته
- تنظیمات سیستم با پشتیبانی از چندزبانگی و پشتیبان‌گیری
- نمایش وضعیت اکانت‌ها با رنگ‌های مناسب
- کپی یک‌کلیکی تنظیمات اکانت
- نمایش QR کد برای اتصال سریع
- نمودار مصرف ترافیک روزانه
- جزئیات کامل تراکنش‌های مالی

## بهبودهای رابط کاربری
- طراحی مدرن با تم تیره
- پشتیبانی کامل از زبان فارسی
- فرمت‌بندی اعداد به فارسی
- نمایش تاریخ به صورت شمسی
- رابط کاربری واکنش‌گرا برای تمام دستگاه‌ها

## مراحل بعدی
1. تکمیل پردازش پرداخت
   - اتصال به درگاه پرداخت
   - نمایش تاریخچه تراکنش‌ها
   - تولید و دانلود فاکتور
2. راه‌اندازی Docker
   - تنظیمات Docker Compose
   - متغیرهای محیطی
   - مدیریت حجم‌ها
3. اضافه کردن نظارت و ثبت
   - نظارت بر سرورها
   - ثبت رویدادها
   - ردیابی خطاها
4. تکمیل مستندات
   - راهنمای نصب
   - راهنمای توسعه
   - بروزرسانی مستندات API

## نصب و راه‌اندازی

### پیش‌نیازها
- Python 3.8+
- Docker و Docker Compose
- سرور با سیستم‌عامل Ubuntu 22.04

### نصب
1. کلون کردن مخزن:
```bash
git clone https://github.com/username/v2ray-management.git
cd v2ray-management
```

2. اجرای اسکریپت نصب:
```bash
chmod +x install.sh
./install.sh
```

3. تنظیم وبهوک تلگرام:
```bash
python bot/set_webhook.py --token YOUR_BOT_TOKEN --url https://your-domain.com/webhook
```

## توسعه‌دهندگان
برای توسعه و تست محلی، می‌توانید از دستورات زیر استفاده کنید:

1. ایجاد محیط مجازی:
```bash
python -m venv venv
source venv/bin/activate  # در لینوکس
venv\Scripts\activate  # در ویندوز
```

2. نصب وابستگی‌ها:
```bash
pip install -r requirements.txt
```

3. اجرای ربات در حالت پولینگ:
```bash
python bot/polling.py
```

## مستندات بیشتر
برای اطلاعات بیشتر، به فایل‌های زیر مراجعه کنید:
- `docs/user-guide.md`: راهنمای کاربران
- `docs/admin-guide.md`: راهنمای مدیران
- `docs/developer-guide.md`: راهنمای توسعه‌دهندگان 

# داشبورد وی‌تو‌ری (V2Ray)

## بخش‌های تکمیل شده

### داشبورد کاربری
داشبورد کاربری با ویژگی‌های زیر پیاده‌سازی شده است:

- **صفحه اصلی داشبورد**: نمایش خلاصه وضعیت حساب، ترافیک مصرفی و اعتبار باقی‌مانده
- **کارت کیف پول**: نمایش موجودی کیف پول و امکان افزایش اعتبار
- **نمودار مصرف ترافیک**: نمایش بصری میزان آپلود و دانلود به صورت نمودار
- **کارت‌های اکانت**: نمایش وضعیت اکانت‌ها، تاریخ انقضا و میزان ترافیک مصرفی
- **تراکنش‌های اخیر**: جدول نمایش آخرین تراکنش‌های مالی

### مدیریت اکانت‌ها
بخش مدیریت اکانت‌ها شامل موارد زیر است:

- **لیست اکانت‌ها**: مشاهده تمام اکانت‌های کاربر با امکان فیلتر و جستجو
- **ایجاد اکانت جدید**: فرم ساخت اکانت جدید با انتخاب پلن و سرور
- **تاریخچه اکانت‌ها**: مشاهده سوابق اکانت‌های قبلی و فعلی

### پنل مدیریت
پنل مدیریت (ادمین) شامل ویژگی‌های زیر است:

- **داشبورد مدیریت**: نمایش آمار کلی، گزارش درآمد و فعالیت‌های اخیر
- **مدیریت کاربران**: امکان مشاهده، افزودن، ویرایش و حذف کاربران
- **مدیریت سرورها**: کنترل سرورهای V2Ray، وضعیت آنها و تنظیمات مربوطه
- **مدیریت پلن‌ها**: تعریف و مدیریت پلن‌های اشتراک با قیمت و ویژگی‌های مختلف
- **گزارش‌های مالی**: نمودارها و جداول گزارش‌گیری از تراکنش‌ها و درآمدها
- **تنظیمات سیستم**: تنظیمات عمومی، اعلان‌ها و پشتیبان‌گیری

### سیستم پرداخت
سیستم پرداخت با ویژگی‌های زیر پیاده‌سازی شده است:

- **افزایش موجودی کیف پول**: امکان شارژ کیف پول با مبالغ از پیش تعریف شده یا مبلغ دلخواه
- **پرداخت کارت به کارت**: فرآیند پرداخت مرحله به مرحله با آپلود رسید و تأیید
- **پرداخت آنلاین زرین‌پال**: اتصال به درگاه پرداخت زرین‌پال برای تراکنش‌های آنلاین
- **تاریخچه پرداخت‌ها**: نمایش سوابق تمام تراکنش‌ها با امکان فیلتر و جستجو

## جزئیات پیاده‌سازی

### داشبورد کاربری
داشبورد کاربری با استفاده از کتابخانه Material-UI طراحی شده و شامل کامپوننت‌های زیر است:

- کارت خلاصه وضعیت حساب با نمایش اطلاعات کلیدی
- نمودار ترافیک با استفاده از کتابخانه Recharts برای نمایش بصری داده‌ها
- کارت‌های اکانت با رنگ‌بندی وضعیت (فعال، منقضی، در حال اتمام)
- جدول تراکنش‌ها با قابلیت مرتب‌سازی و صفحه‌بندی

### مدیریت اکانت‌ها
صفحات مدیریت اکانت با ویژگی‌های زیر پیاده‌سازی شده‌اند:

- نمایش اکانت‌ها در قالب کارت‌ها و جدول با اطلاعات کامل
- فرم ایجاد اکانت با انتخاب پلن، مدت زمان و سرور
- نمایش QR کد و لینک اتصال برای هر اکانت
- امکان تمدید، به‌روزرسانی یا حذف اکانت‌های موجود

### پنل مدیریت
پنل مدیریت (ادمین) شامل موارد زیر است:

- نمودارهای آماری برای نمایش وضعیت سیستم و درآمد
- مدیریت کاربران با امکان جستجو، فیلتر و ویرایش اطلاعات
- مدیریت سرورها با نمایش وضعیت آنلاین، بارگذاری و ترافیک
- مدیریت پلن‌ها با تعیین قیمت، حجم ترافیک و مدت زمان
- گزارش‌های مالی با نمودارهای درآمد روزانه/ماهانه و جزئیات تراکنش‌ها
- تنظیمات سیستم شامل:
  - تنظیمات عمومی (نام سایت، زبان، وضعیت تعمیرات)
  - تنظیمات اعلان‌ها (ایمیل، تلگرام)
  - مدیریت پشتیبان‌گیری (زمان‌بندی، مکان ذخیره‌سازی)

### سیستم پرداخت
سیستم پرداخت با جزئیات زیر پیاده‌سازی شده است:

#### افزایش موجودی کیف پول
- انتخاب مبلغ از گزینه‌های از پیش تعیین شده یا ورود مبلغ دلخواه
- انتخاب روش پرداخت (کارت به کارت یا زرین‌پال)
- پیش‌نمایش و تأیید نهایی برای ادامه فرآیند پرداخت

#### پرداخت کارت به کارت
- فرآیند پرداخت چند مرحله‌ای با راهنمای گام به گام
- انتخاب پلن اشتراک یا مبلغ دلخواه
- نمایش اطلاعات کارت و مبلغ قابل پرداخت
- آپلود تصویر رسید پرداخت و ورود اطلاعات تراکنش
- صفحه تأیید پرداخت و انتظار برای بررسی

#### پرداخت آنلاین زرین‌پال
- انتخاب پلن اشتراک یا مبلغ دلخواه
- ورود اطلاعات تماس برای رسید پرداخت
- اتصال به درگاه پرداخت زرین‌پال
- بررسی و تأیید خودکار پرداخت
- فعال‌سازی خودکار سرویس پس از تأیید پرداخت

#### تاریخچه پرداخت‌ها
- جدول کامل تراکنش‌ها با جزئیات هر پرداخت
- فیلترهای پیشرفته بر اساس تاریخ، مبلغ، وضعیت و روش پرداخت
- جستجو در تراکنش‌ها بر اساس شناسه یا توضیحات
- امکان مشاهده جزئیات و دانلود فاکتور برای هر تراکنش

## ویژگی‌های عمومی

تمام بخش‌های پروژه دارای ویژگی‌های زیر هستند:

- **پشتیبانی RTL**: طراحی کامل راست به چپ برای زبان فارسی
- **قالب تاریخ شمسی**: نمایش تاریخ‌ها بر اساس تقویم هجری شمسی
- **قالب اعداد فارسی**: نمایش اعداد به فرمت فارسی و تومان
- **طراحی واکنش‌گرا**: سازگاری با تمام اندازه‌های نمایشگر (موبایل، تبلت و دسکتاپ)
- **تم تاریک**: رابط کاربری با تم تاریک برای راحتی چشم

## گام‌های بعدی

مراحل بعدی پروژه شامل موارد زیر است:

- پیاده‌سازی سیستم احراز هویت (ورود، ثبت‌نام و بازیابی رمز عبور)
- توسعه API برای ارتباط با پنل‌های 3x-UI
- پیاده‌سازی ربات تلگرام برای مدیریت و فروش اکانت‌ها
- آماده‌سازی Docker برای راه‌اندازی سریع و آسان
- تکمیل مستندات راهنما برای کاربران و توسعه‌دهندگان 

## سیستم مدیریت VPN

### سیستم احراز هویت

سیستم احراز هویت کاربران با قابلیت‌های زیر پیاده‌سازی شده است:

#### ورود به سیستم
- صفحه ورود به حساب کاربری با طراحی مدرن و کاربرپسند
- امکان ورود با ایمیل و رمز عبور
- قابلیت "مرا به خاطر بسپار" برای حفظ نشست کاربری
- پشتیبانی از ورود با سرویس‌های شخص ثالث (گوگل و گیت‌هاب)
- اعتبارسنجی فرم‌ها و نمایش پیام‌های خطا

#### ثبت‌نام کاربران
- فرآیند ثبت‌نام چند مرحله‌ای و کاربرپسند
- مرحله اول: وارد کردن اطلاعات حساب (ایمیل و رمز عبور)
- مرحله دوم: وارد کردن اطلاعات شخصی (نام و شماره موبایل)
- مرحله سوم: تأیید شماره موبایل با کد ارسال شده
- امکان بازگشت به مراحل قبلی
- نمایش وضعیت پیشرفت با استفاده از Stepper
- اعتبارسنجی هر مرحله و نمایش پیام‌های خطا

#### بازیابی رمز عبور
- فرآیند بازیابی رمز عبور در سه مرحله
- مرحله اول: درخواست بازیابی با وارد کردن ایمیل
- مرحله دوم: تأیید کد ارسال شده به ایمیل
- مرحله سوم: تعیین رمز عبور جدید
- امکان ارسال مجدد کد تأیید
- اعتبارسنجی رمز عبور جدید

#### ویژگی‌های کلی
- پشتیبانی کامل از زبان فارسی (RTL)
- امکان تغییر زبان (فارسی/انگلیسی)
- امکان تغییر تم (روشن/تاریک)
- طراحی واکنش‌گرا برای همه دستگاه‌ها
- استفاده از Material-UI برای رابط کاربری مدرن
- مدیریت نشست کاربری
- امنیت اطلاعات و رمزنگاری

### پنل مدیریت

پنل مدیریت با امکانات زیر پیاده‌سازی شده است:

#### داشبورد مدیریت
- نمای کلی از وضعیت سیستم
- آمار و گراف‌های کاربران، سرورها و درآمد
- فعالیت‌های اخیر سیستم
- اعلان‌های مهم

#### مدیریت کاربران
- لیست کاربران با امکان جستجو و فیلتر
- مشاهده جزئیات هر کاربر
- ویرایش اطلاعات کاربران
- فعال/غیرفعال کردن حساب کاربری
- حذف کاربر
- تغییر سطح دسترسی

#### مدیریت سرورها
- اضافه کردن سرور‌های V2Ray جدید
- نمایش وضعیت سرورها (آنلاین/آفلاین)
- آمار مصرف ترافیک هر سرور
- تنظیمات سرور (پورت، پروتکل، تنظیمات امنیتی)
- همگام‌سازی با پنل‌های 3x-UI
- حذف سرور

#### مدیریت پلن‌ها
- تعریف پلن‌های اشتراک جدید
- تعیین مدت زمان، حجم ترافیک و قیمت
- انتخاب سرورهای مجاز برای هر پلن
- تنظیم پروتکل‌های مجاز
- فعال/غیرفعال کردن پلن‌ها
- تکثیر پلن‌های موجود

#### گزارش‌های مالی
- نمودار درآمد (روزانه، هفتگی، ماهانه، سالانه)
- لیست تراکنش‌ها با جزئیات
- گزارش فروش به تفکیک پلن‌ها
- صادر کردن گزارش‌ها

#### تنظیمات سیستم
- تنظیمات کلی (نام سایت، توضیحات، ایمیل ادمین)
- تنظیمات زبان و ظاهر سیستم
- تنظیمات اعلان‌ها (ایمیل، تلگرام)
- تنظیمات پشتیبان‌گیری
- حالت تعمیر و نگهداری

### مراحل بعدی
1. پیاده‌سازی سیستم مدیریت نقش‌ها و دسترسی‌ها
2. تکمیل پنل کاربری
3. پیاده‌سازی درگاه‌های پرداخت
4. ایجاد بات تلگرام
5. تنظیمات داکر
6. تکمیل مستندات

### فناوری‌ها
- فرانت‌اند: React، Material-UI، RTL Support
- بک‌اند: Node.js، Express
- دیتابیس: MongoDB
- احراز هویت: JWT
- چند زبانه: i18next
- ساختار پروژه: پوشه‌بندی براساس ویژگی‌ها (Feature-based) 