# MRJBot - سیستم مدیریت حساب‌های VPN

<div dir="rtl">

## 📋 معرفی

MRJBot یک سیستم کامل برای مدیریت حساب‌های VPN است که شامل یک بات تلگرام، داشبورد وب و API مدیریت می‌باشد. این سیستم به شما امکان می‌دهد تا به راحتی حساب‌های VPN را ایجاد، مدیریت و پیگیری کنید.

### 🌟 ویژگی‌های اصلی

- **بات تلگرام**: ارتباط مستقیم با کاربران، فروش اشتراک و پشتیبانی
- **داشبورد مدیریت**: رابط کاربری زیبا و کاربرپسند برای مدیریت حساب‌ها
- **API قدرتمند**: امکان اتصال به سرویس‌های مختلف
- **سیستم پرداخت**: پشتیبانی از پرداخت کارت به کارت با تأیید دستی
- **گزارش‌گیری**: آمار فروش روزانه، هفتگی و ماهانه
- **سیستم امتیازدهی**: امتیاز برای خرید و معرفی دوستان
- **چت زنده**: ارتباط مستقیم کاربران با پشتیبانی
- **پیشنهاد هوشمند**: پیشنهاد پلن‌های مناسب بر اساس الگوی مصرف

## 🚀 نصب و راه‌اندازی

### پیش‌نیازها

- سیستم عامل Ubuntu 20.04 یا 22.04
- دسترسی root
- Docker و Docker Compose
- دامنه یا IP عمومی

### نصب خودکار

برای نصب خودکار، کافیست دستور زیر را اجرا کنید:

```bash
curl -fsSL https://raw.githubusercontent.com/username/mrjbot/main/install.sh | sudo bash
```

یا اگر فایل نصب را دانلود کرده‌اید:

```bash
sudo bash install.sh
```

### نصب دستی

1. مخزن را کلون کنید:
```bash
git clone https://github.com/username/mrjbot.git /opt/mrjbot
```

2. به دایرکتوری نصب بروید:
```bash
cd /opt/mrjbot
```

3. فایل `.env` را ایجاد و تنظیم کنید:
```bash
cp .env.example .env
nano .env
```

4. سرویس‌ها را راه‌اندازی کنید:
```bash
docker-compose up -d
```

## 💻 استفاده از سیستم

### دستورات CLI

MRJBot دارای یک ابزار خط فرمان برای مدیریت آسان سیستم است:

```bash
# شروع سرویس‌ها
mrjbot start

# توقف سرویس‌ها
mrjbot stop

# راه‌اندازی مجدد سرویس‌ها
mrjbot restart

# نمایش وضعیت سرویس‌ها
mrjbot status

# نمایش لاگ‌ها
mrjbot logs [نام سرویس]

# ورود به شل کانتینر
mrjbot shell [نام سرویس]

# بروزرسانی سیستم
mrjbot update

# تهیه پشتیبان
mrjbot backup

# بازیابی پشتیبان
mrjbot restore [نام فایل]

# تنظیم کد لایسنس
mrjbot set-license [کد]

# اجرای تست‌ها
mrjbot test

# شروع سیستم مانیتورینگ
mrjbot monitoring-start

# توقف سیستم مانیتورینگ
mrjbot monitoring-stop

# نمایش راهنما
mrjbot help
```

### دسترسی به داشبورد

پس از نصب، می‌توانید با مراجعه به آدرس زیر به داشبورد مدیریت دسترسی پیدا کنید:

```
http://YOUR_DOMAIN_OR_IP/admin
```

نام کاربری و رمز عبور پیش‌فرض:
- نام کاربری: `admin`
- رمز عبور: `admin`

⚠️ **مهم**: پس از اولین ورود، حتماً رمز عبور را تغییر دهید.

### تنظیم بات تلگرام

1. با [@BotFather](https://t.me/BotFather) در تلگرام چت کنید و یک بات جدید بسازید
2. توکن دریافتی را در فایل `.env` در متغیر `TELEGRAM_BOT_TOKEN` قرار دهید
3. سرویس بات را راه‌اندازی مجدد کنید:
```bash
mrjbot restart bot
```

## 🔧 پیکربندی

### فایل‌های پیکربندی اصلی

- `.env`: متغیرهای محیطی و تنظیمات اصلی
- `docker-compose.yml`: پیکربندی سرویس‌های Docker
- `backend/config/settings.py`: تنظیمات Django
- `bot/config.py`: تنظیمات بات تلگرام

### تنظیمات پیشرفته

برای تنظیمات پیشرفته‌تر، می‌توانید فایل‌های زیر را ویرایش کنید:

- `backend/config/settings_production.py`: تنظیمات محیط تولید
- `nginx/conf.d/default.conf`: تنظیمات Nginx
- `monitoring/prometheus/prometheus.yml`: تنظیمات Prometheus

## 📊 مانیتورینگ

MRJBot دارای یک سیستم مانیتورینگ کامل بر پایه Prometheus و Grafana است:

### نصب سیستم مانیتورینگ

```bash
sudo bash install_monitoring.sh
```

### دسترسی به داشبوردها

- Grafana: `http://YOUR_DOMAIN_OR_IP:3000`
  - نام کاربری: `admin`
  - رمز عبور: `mrjbot_admin`
- Prometheus: `http://YOUR_DOMAIN_OR_IP:9090`

## 🔄 بروزرسانی

برای بروزرسانی سیستم به آخرین نسخه، از دستور زیر استفاده کنید:

```bash
mrjbot update
```

یا مستقیماً:

```bash
sudo bash update.sh
```

## 💾 پشتیبان‌گیری و بازیابی

### تهیه پشتیبان

```bash
mrjbot backup
```

پشتیبان‌ها در مسیر `/opt/mrjbot/backups` ذخیره می‌شوند.

### بازیابی پشتیبان

```bash
mrjbot restore [نام فایل پشتیبان]
```

## 🔍 عیب‌یابی

### بررسی سلامت سیستم

برای بررسی سلامت تمام اجزای سیستم:

```bash
bash health_check.sh --all
```

یا برای بررسی یک جزء خاص:

```bash
bash health_check.sh --db     # بررسی دیتابیس
bash health_check.sh --redis  # بررسی ردیس
bash health_check.sh --api    # بررسی API
bash health_check.sh --bot    # بررسی بات تلگرام
```

### مشکلات رایج

#### بات تلگرام کار نمی‌کند
- بررسی کنید که توکن بات در فایل `.env` به درستی تنظیم شده باشد
- لاگ‌های بات را بررسی کنید: `mrjbot logs bot`

#### خطای اتصال به دیتابیس
- بررسی کنید که سرویس PostgreSQL در حال اجرا باشد: `mrjbot status`
- تنظیمات دیتابیس در فایل `.env` را بررسی کنید

#### داشبورد وب قابل دسترسی نیست
- بررسی کنید که سرویس Nginx در حال اجرا باشد: `mrjbot status`
- لاگ‌های Nginx را بررسی کنید: `mrjbot logs nginx`

## 📝 لایسنس

این پروژه تحت لایسنس اختصاصی منتشر شده است. برای استفاده از آن نیاز به کد لایسنس معتبر دارید.

## 📞 پشتیبانی

برای دریافت پشتیبانی می‌توانید از طریق زیر با ما در ارتباط باشید:

- ایمیل: support@example.com
- تلگرام: [@MRJBotSupport](https://t.me/MRJBotSupport)

</div>