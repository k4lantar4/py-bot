# راهنمای استفاده از داکر برای پروژه 3X-UI Management System

این راهنما به شما کمک می‌کند تا پروژه 3X-UI Management System را با استفاده از داکر راه‌اندازی کنید.

## پیش‌نیازها

- سیستم‌عامل Linux یا Windows با WSL2
- داکر و داکر کامپوز (به صورت خودکار توسط اسکریپت نصب می‌شوند)
- حداقل 2GB RAM و 10GB فضای ذخیره‌سازی

## راه‌اندازی سریع

برای راه‌اندازی سریع پروژه، کافی است اسکریپت `docker_setup.sh` را اجرا کنید:

```bash
./docker_setup.sh
```

این اسکریپت به صورت خودکار:
1. داکر و داکر کامپوز را در صورت نیاز نصب می‌کند
2. فایل `.env` را از روی `.env.docker` ایجاد می‌کند (اگر وجود نداشته باشد)
3. کانتینرهای داکر را می‌سازد و اجرا می‌کند
4. وضعیت کانتینرها را نمایش می‌دهد
5. اطلاعات دسترسی به سرویس‌ها را نمایش می‌دهد

## راه‌اندازی دستی

اگر می‌خواهید پروژه را به صورت دستی راه‌اندازی کنید، مراحل زیر را دنبال کنید:

1. اطمینان حاصل کنید که داکر و داکر کامپوز نصب هستند:
   ```bash
   docker --version
   docker-compose --version
   ```

2. فایل `.env` را از روی `.env.docker` ایجاد کنید:
   ```bash
   cp .env.docker .env
   ```

3. فایل `.env` را با مقادیر مورد نظر خود ویرایش کنید.

4. کانتینرها را بسازید و اجرا کنید:
   ```bash
   docker-compose up -d --build
   ```

5. وضعیت کانتینرها را بررسی کنید:
   ```bash
   docker-compose ps
   ```

## دسترسی به سرویس‌ها

پس از راه‌اندازی موفقیت‌آمیز، می‌توانید به سرویس‌های زیر دسترسی داشته باشید:

- **بک‌اند API**: http://localhost:8000/api
- **مستندات API**: http://localhost:8000/api/docs
- **فرانت‌اند**: http://localhost:3000
- **phpMyAdmin**: http://localhost:8080
  - نام کاربری: `root`
  - رمز عبور: `rootpassword`

## دستورات مفید

- **مشاهده لاگ‌ها**:
  ```bash
  docker-compose logs -f
  ```

- **مشاهده لاگ یک سرویس خاص**:
  ```bash
  docker-compose logs -f [نام-سرویس]
  ```
  مثال: `docker-compose logs -f backend`

- **راه‌اندازی مجدد سرویس‌ها**:
  ```bash
  docker-compose restart
  ```

- **راه‌اندازی مجدد یک سرویس خاص**:
  ```bash
  docker-compose restart [نام-سرویس]
  ```

- **توقف سرویس‌ها**:
  ```bash
  docker-compose down
  ```

- **حذف کامل سرویس‌ها و حجم‌ها**:
  ```bash
  docker-compose down -v
  ```

## حل مشکلات رایج

### مشکل 1: خطای دسترسی به پورت

اگر با خطای "port is already allocated" مواجه شدید:

1. بررسی کنید کدام برنامه از پورت مورد نظر استفاده می‌کند:
   ```bash
   sudo lsof -i :[شماره-پورت]
   ```

2. پورت را در فایل `docker-compose.yml` تغییر دهید یا برنامه استفاده‌کننده را متوقف کنید.

### مشکل 2: خطای دسترسی به پایگاه داده

اگر سرویس بک‌اند نمی‌تواند به پایگاه داده متصل شود:

1. مطمئن شوید که سرویس `db` در حال اجراست:
   ```bash
   docker-compose ps
   ```

2. لاگ‌های سرویس `db` را بررسی کنید:
   ```bash
   docker-compose logs db
   ```

3. وارد کانتینر `db` شوید و اتصال را بررسی کنید:
   ```bash
   docker-compose exec db mysql -u user -p
   ```

### مشکل 3: عدم نمایش صحیح فرانت‌اند

اگر فرانت‌اند به درستی نمایش داده نمی‌شود:

1. لاگ‌های سرویس `frontend` را بررسی کنید:
   ```bash
   docker-compose logs frontend
   ```

2. مطمئن شوید که آدرس API در فرانت‌اند به درستی تنظیم شده است (در فایل `.env`).

## تغییر پیکربندی

اگر می‌خواهید پیکربندی داکر را تغییر دهید:

1. فایل `docker-compose.yml` را ویرایش کنید.
2. تغییرات را اعمال کنید:
   ```bash
   docker-compose up -d --build
   ```

## مستندات بیشتر

برای اطلاعات بیشتر درباره پروژه، به فایل `README.md` اصلی مراجعه کنید. 